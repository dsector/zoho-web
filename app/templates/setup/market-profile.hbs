<h1>Market Profile</h1>
<hr/>

<div class="row">
    <div class="col-md-12">
        <div class="panel panel-default">
            <div class="panel-heading">
                Create a new market profile
            </div>
            <div class="panel-body">
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label>Market profile name</label>
                          {{input type="text" value=newProfile.name class="form-control"}}
                        </div>
                    </div>
                    <div class="col-md-2 pull-right">
                        <div class="form-group">
                        </div>
                    </div>
                </div>
                <div class="row">
                    <table class="table">
                        <thead>
                        <tr>
                            <th class="col-md-3">Product</th>
                            <th>Federal</th>
                            <th>State</th>
                            <th>Utility</th>
                            <th>Tax</th>
                            <th>Rebates</th>
                            <th></th>
                        </tr>
                        </thead>
                        <tbody>
                        {{#each item in newProfile.items}}
                            <tr>
                                <td>{{item.product.name}}</td>
                                <td>{{item.federal}}%</td>
                                <td>{{item.state}}</td>
                                <td>{{item.utility}}</td>
                                <td>{{item.tax}}</td>
                                <td>{{item.rebates}}</td>
                            </tr>
                        {{/each}}
                        <tr>
                            <td>
                                {{view "select"
                                  content=products
                                  optionLabelPath="content.name"
                                  value=newItem.product
                                  class="form-control input-sm"
                                }}
                            </td>
                            <td>{{input type="text" class="form-control input-sm" value=newItem.federal}}</td>
                            <td>{{input type="text" class="form-control input-sm" value=newItem.state}}</td>
                            <td>{{input type="text" class="form-control input-sm" value=newItem.utility}}</td>
                            <td>{{input type="text" class="form-control input-sm" value=newItem.tax}}</td>
                            <td>{{input type="text" class="form-control input-sm" value=newItem.rebates}}</td>
                            <td>
                                <button {{action 'addItem'}} class="btn btn-primary btn-sm">Add</button>
                            </td>
                        </tr>
                        </tbody>
                    </table>

                    <div class="col-md-2">
                        <button type="button" {{action 'saveProfile'}} class="btn btn-success">Save</button>
                    </div>
                </div>
            </div>

        </div>
      {{#each prof in model}}
        <div class="panel panel-default">
            <div class="panel-heading">
              {{prof.name}}
            </div>
            <div class="panel-body">
                  <div class="row">
                      <table class="table">
                          <thead>
                          <tr>
                              <th class="col-md-3">Product</th>
                              <th>Federal</th>
                              <th>State</th>
                              <th>Utility</th>
                              <th>Tax</th>
                              <th>Rebates</th>
                              <th></th>
                          </tr>
                          </thead>
                          <tbody>
                          {{#each it in prof.items}}
                              <tr>
                                  <td>{{it.product.name}}</td>
                                  <td>{{it.federal}}%</td>
                                  <td>{{it.state}}</td>
                                  <td>{{it.utility}}</td>
                                  <td>{{it.tax}}</td>
                                  <td>{{it.rebates}}</td>
                                  <td>
                                      <button type="button" {{action 'deleteSavedItem' prof it}}class="btn btn-danger btn-sm">Delete</button>
                                  </td>
                              </tr>
                          {{/each}}
                          </tbody>
                      </table>
                  </div>
                  <button class="btn btn-success" {{action 'updateSavedProfile' prof}}>Update</button>
                  <button class="btn btn-danger" {{action 'deleteSavedProfile' prof}}>Delete profile</button>
            </div>
        </div>
      {{/each}}

    </div>
</div>
